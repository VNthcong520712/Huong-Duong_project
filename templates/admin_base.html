<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Tiêu đề sẽ được thay đổi bởi các template con -->
    <title>{% block title %}Hệ Thống Quản Lý{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style> 
        body { font-family: 'Inter', sans-serif; } 
        /* Thêm các style dùng chung cho admin ở đây nếu cần */
        {% block extra_styles %}{% endblock %}
    </style>
</head>
<body class="bg-gray-100">
    <!-- Navbar chung (CẬP NHẬT) -->
    <nav class="bg-indigo-600 text-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <a href="{{ url_for('quanlybanhang.main_page') }}" class="font-bold text-xl">Hệ Thống Quản Lý</a>
                </div>
                <!-- Kiểm tra request.path để highlight tab hiện tại -->
                {% set active_page = request.path %}
                
                <!-- Menu Desktop (Ẩn trên mobile) -->
                <div class="hidden sm:flex sm:items-center sm:space-x-4">
                    <a href="{{ url_for('quanlybanhang.main_page') }}" 
                       class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.main_page') else '' }} hover:bg-indigo-700 px-3 py-2 rounded-md text-sm font-medium">Trang Chính</a>
                    
                    <a href="{{ url_for('quanlybanhang.messages_page') }}" 
                       class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.messages_page') else '' }} hover:bg-indigo-700 px-3 py-2 rounded-md text-sm font-medium">Tin Nhắn</a>

                    <a href="{{ url_for('quanlybanhang.transaction_page') }}" 
                       class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.transaction_page') else '' }} hover:bg-indigo-700 px-3 py-2 rounded-md text-sm font-medium">Giao Dịch</a>
                    
                    <a href="{{ url_for('quanlybanhang.statistics_page') }}" 
                       class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.statistics_page') else '' }} hover:bg-indigo-700 px-3 py-2 rounded-md text-sm font-medium">Thống Kê</a>
                    
                    <a href="{{ url_for('quanlybanhang.products_page') }}" 
                       class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.products_page') else '' }} hover:bg-indigo-700 px-3 py-2 rounded-md text-sm font-medium">Sản Phẩm</a>
                    
                    <a href="{{ url_for('quanlybanhang.gallery_page') }}" 
                       class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.gallery_page') else '' }} hover:bg-indigo-700 px-3 py-2 rounded-md text-sm font-medium">Thư Viện Ảnh</a>
                    
                    <a href="{{ url_for('quanlybanhang.settings_page') }}" 
                       class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.settings_page') else '' }} hover:bg-indigo-700 px-3 py-2 rounded-md text-sm font-medium">Cài Đặt</a>
                    
                    <a href="{{ url_for('quanlybanhang.logout') }}" class="bg-red-500 hover:bg-red-600 px-3 py-2 rounded-md text-sm font-medium">Đăng xuất</a>
                </div>

                <!-- MỚI: Nút Hamburger (Mobile) -->
                <div class="sm:hidden flex items-center">
                    <button id="admin-mobile-menu-button" type="button" class="inline-flex items-center justify-center p-2 rounded-md text-indigo-200 hover:text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" aria-controls="admin-mobile-menu" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <!-- Icon hamburger (khi đóng) -->
                        <svg id="admin-hamburger-open" class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                        <!-- Icon close (khi mở) -->
                        <svg id="admin-hamburger-close" class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>

            </div>
        </div>

        <!-- MỚI: Menu Mobile (Thả xuống) -->
        <div class="sm:hidden hidden" id="admin-mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="{{ url_for('quanlybanhang.main_page') }}" class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.main_page') else '' }} text-white block px-3 py-2 rounded-md text-base font-medium hover:bg-indigo-700">Trang Chính</a>
                <a href="{{ url_for('quanlybanhang.messages_page') }}" class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.messages_page') else '' }} text-white block px-3 py-2 rounded-md text-base font-medium hover:bg-indigo-700">Tin Nhắn</a>
                <a href="{{ url_for('quanlybanhang.transaction_page') }}" class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.transaction_page') else '' }} text-white block px-3 py-2 rounded-md text-base font-medium hover:bg-indigo-700">Giao Dịch</a>
                <a href="{{ url_for('quanlybanhang.statistics_page') }}" class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.statistics_page') else '' }} text-white block px-3 py-2 rounded-md text-base font-medium hover:bg-indigo-700">Thống Kê</a>
                <a href="{{ url_for('quanlybanhang.products_page') }}" class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.products_page') else '' }} text-white block px-3 py-2 rounded-md text-base font-medium hover:bg-indigo-700">Sản Phẩm</a>
                <a href="{{ url_for('quanlybanhang.gallery_page') }}" class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.gallery_page') else '' }} text-white block px-3 py-2 rounded-md text-base font-medium hover:bg-indigo-700">Thư Viện Ảnh</a>
                <a href="{{ url_for('quanlybanhang.settings_page') }}" class="{{ 'bg-indigo-700' if active_page == url_for('quanlybanhang.settings_page') else '' }} text-white block px-3 py-2 rounded-md text-base font-medium hover:bg-indigo-700">Cài Đặt</a>
                <hr class="border-indigo-500 my-2">
                <a href="{{ url_for('quanlybanhang.logout') }}" class="block px-3 py-2 rounded-md text-base font-medium text-white bg-red-500 hover:bg-red-600">Đăng xuất</a>
            </div>
        </div>
    </nav>

    <!-- Khu vực nội dung chính -->
    <main>
        <!-- Hiển thị thông báo Flash (nếu có) -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8 -mb-4">
            {% for category, message in messages %}
              <div class="p-4 rounded-md {{ 'bg-green-100 text-green-700' if category == 'success' else 'bg-red-100 text-red-700' }}" role="alert">
                {{ message }}
              </div>
            {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        <!-- Nội dung của template con sẽ được chèn vào đây -->
        {% block content %}
        {% endblock %}
    </main>

    <!-- Script chung (nếu cần) -->
    {% block scripts %}
    {% endblock %}

    <!-- SỬA LỖI: Chuyển Script menu mobile ra ngoài block -->
    <script>
        // --- MỚI: Script cho menu Mobile Admin ---
        // (Sử dụng ID khác với shop_base để tránh xung đột nếu có)
        const adminMenuButton = document.getElementById('admin-mobile-menu-button');
        const adminMobileMenu = document.getElementById('admin-mobile-menu');
        const adminIconOpen = document.getElementById('admin-hamburger-open');
        const adminIconClose = document.getElementById('admin-hamburger-close');

        if (adminMenuButton && adminMobileMenu && adminIconOpen && adminIconClose) {
            adminMenuButton.addEventListener('click', () => {
                const isExpanded = adminMenuButton.getAttribute('aria-expanded') === 'true';
                adminMenuButton.setAttribute('aria-expanded', !isExpanded);
                adminMobileMenu.classList.toggle('hidden');
                adminIconOpen.classList.toggle('hidden');
                adminIconClose.classList.toggle('hidden');
            });
        }
    </script>

    <!-- MỚI: Script chặn Inspect Element -->
    <script>
        // Chặn click chuột phải
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });

        // Chặn các phím tắt mở DevTools
        document.addEventListener('keydown', function(e) {
            // F12
            if (e.keyCode == 123) {
                e.preventDefault();
            }
            // Ctrl + Shift + I
            if (e.ctrlKey && e.shiftKey && e.keyCode == 73) { // 73 is 'I'
                e.preventDefault();
            }
            // Ctrl + Shift + J
            if (e.ctrlKey && e.shiftKey && e.keyCode == 74) { // 74 is 'J'
                e.preventDefault();
            }
            // Ctrl + U
            if (e.ctrlKey && e.keyCode == 85) { // 85 is 'U'
                e.preventDefault();
            }
        });
    </script>
</body>
</html>

